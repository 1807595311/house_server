{"version":3,"file":"js/657.204483cf.js","mappings":"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","sources":["webpack://client/./src/components/Address.vue","webpack://client/src/components/Address.vue","webpack://client/./src/components/Address.vue?21f9","webpack://client/./src/components/Address.vue?a7b6","webpack://client/./src/views/tabViews/ReleaseDynamics.vue","webpack://client/src/views/tabViews/ReleaseDynamics.vue","webpack://client/./src/views/tabViews/ReleaseDynamics.vue?3136","webpack://client/./src/views/tabViews/ReleaseDynamics.vue?1293"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('Cascader',{attrs:{\"value\":_vm.value,\"data\":_vm.data3,\"placeholder\":_vm.placeholder,\"render-format\":_vm.format},on:{\"on-change\":_vm.change}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <Cascader :value=\"value\" :data=\"data3\" :placeholder=\"placeholder\" :render-format=\"format\" @on-change=\"change\"></Cascader>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport address from \"@/utils/address.json\";\r\nexport default {\r\n  name: \"ClientAddressSelect\",\r\n  props: {\r\n    placeholder:{\r\n        type: String,\r\n        default: '请选择所在城市'\r\n    },\r\n    value: {\r\n      type: Array\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      data3: [],\r\n    };\r\n  },\r\n  created() {\r\n    this.data3 = address.map((v) => {\r\n      return {\r\n        code: v.code,\r\n        value: v.label,\r\n        label: v.label,\r\n        children: v.children.map((vle) => {\r\n          return {\r\n            code: vle.code,\r\n            label: vle.label,\r\n            value: vle.label,\r\n          };\r\n        }),\r\n      };\r\n    });\r\n  },\r\n  methods: {\r\n    format(labels, selectedData) {\r\n      const index = labels.length - 1;\r\n      const data = selectedData[index] || false;\r\n      if (data && data.code) {\r\n        return labels[index];\r\n      }\r\n      return labels[index];\r\n    },\r\n    change(value) {\r\n      this.$emit(\"getAddress\", value[1]);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Address.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Address.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Address.vue?vue&type=template&id=64b68f86&scoped=true&\"\nimport script from \"./Address.vue?vue&type=script&lang=js&\"\nexport * from \"./Address.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"64b68f86\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"releaseDynamics\"},[_c('div',{staticClass:\"form\"},[_c('Form',{ref:\"formValidate\",attrs:{\"model\":_vm.formValidate,\"rules\":_vm.ruleValidate,\"label-width\":80}},[_c('Form-item',{staticStyle:{\"width\":\"500px\"},attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('Input',{attrs:{\"size\":\"large\",\"placeholder\":\"标题(2-30字)\"},model:{value:(_vm.formValidate.title),callback:function ($$v) {_vm.$set(_vm.formValidate, \"title\", $$v)},expression:\"formValidate.title\"}})],1),_c('Form-item',{attrs:{\"label\":\"标签\"}},_vm._l((_vm.tagList),function(v,i){return _c('Checkbox',{key:i,model:{value:(v.check),callback:function ($$v) {_vm.$set(v, \"check\", $$v)},expression:\"v.check\"}},[_vm._v(_vm._s(v.title))])}),1),_c('Form-item',{staticStyle:{\"width\":\"300px\"},attrs:{\"label\":\"城市\",\"prop\":\"city\"}},[_c('Address',{attrs:{\"value\":_vm.findCity(_vm.formValidate.city)},on:{\"getAddress\":v=>_vm.formValidate.city=v}})],1),_c('Form-item',{attrs:{\"label\":\"风格\"}},[_c('Select',{staticStyle:{\"width\":\"200px\"},model:{value:(_vm.styleId),callback:function ($$v) {_vm.styleId=$$v},expression:\"styleId\"}},_vm._l((_vm.styleList),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(_vm._s(item.name))])}),1)],1),_c('Form-item',{attrs:{\"label\":\"封面\",\"prop\":\"cover\"}},[_c('UploadHeadImg',{attrs:{\"imgUrl\":_vm.editData.cover},on:{\"getFormdata\":v=>_vm.formValidate.cover = v}})],1)],1)],1),_c('div',{staticClass:\"markdown\"},[_c('mavon-editor',{ref:\"md\",attrs:{\"toolbars\":_vm.toolbars},on:{\"fullScreen\":_vm.fullScreen,\"imgAdd\":_vm.imgAdd,\"imgDel\":_vm.imgDel,\"change\":_vm.changeData},model:{value:(_vm.content),callback:function ($$v) {_vm.content=$$v},expression:\"content\"}})],1),_c('div',{staticClass:\"commit-box\"},[_c('Button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.content == '' ? true: false,\"long\":\"\"},on:{\"click\":_vm.releaseDynamics}},[_vm._v(\"发布动态\")])],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"releaseDynamics\">\r\n    <div class=\"form\">\r\n      <Form ref=\"formValidate\" :model=\"formValidate\" :rules=\"ruleValidate\" :label-width=\"80\">\r\n        <Form-item label=\"标题\" prop=\"title\" style=\"width:500px\">\r\n          <Input size=\"large\" v-model=\"formValidate.title\" placeholder=\"标题(2-30字)\"></Input>\r\n        </Form-item>\r\n        <Form-item label=\"标签\">\r\n          <Checkbox v-for=\"(v,i) in tagList\" :key=\"i\" v-model=\"v.check\">{{v.title}}</Checkbox>\r\n        </Form-item>\r\n        <Form-item label=\"城市\" prop=\"city\" style=\"width:300px\">\r\n          <Address :value=\"findCity(formValidate.city)\" @getAddress=\"v=>formValidate.city=v\"></Address>\r\n        </Form-item>\r\n        <Form-item label=\"风格\">\r\n          <Select v-model=\"styleId\" style=\"width:200px\">\r\n            <Option v-for=\"item in styleList\" :value=\"item.id\" :key=\"item.id\">{{ item.name }}</Option>\r\n          </Select>\r\n        </Form-item>\r\n        <Form-item label=\"封面\" prop=\"cover\">\r\n          <UploadHeadImg :imgUrl=\"editData.cover\" @getFormdata=\"v=>formValidate.cover = v\"></UploadHeadImg>\r\n        </Form-item>\r\n      </Form>\r\n    </div>\r\n    <div class=\"markdown\">\r\n      <mavon-editor ref=\"md\" @fullScreen=\"fullScreen\" @imgAdd=\"imgAdd\" @imgDel=\"imgDel\" @change=\"changeData\" v-model=\"content\" :toolbars=\"toolbars\" />\r\n    </div>\r\n    <div class=\"commit-box\">\r\n      <!-- <Button type=\"primary\" long @click=\"testResDy\">testResDy</Button> -->\r\n      <Button type=\"primary\" :disabled=\"content == '' ? true: false\" long @click=\"releaseDynamics\">发布动态</Button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport UploadHeadImg from \"@/components/UploadHeadImg.vue\";\r\nimport Address from \"@/components/Address.vue\";\r\nimport address from \"@/utils/address.json\";\r\nimport { replace, filtion } from \"verification-sensitive\";\r\nexport default {\r\n  name: \"ClientReleaseDynamics\",\r\n  components: {\r\n    UploadHeadImg,\r\n    Address\r\n  },\r\n  data() {\r\n    return {\r\n      formValidate: {\r\n        title: \"\",\r\n        cover: null,\r\n        city: ''\r\n      },\r\n      ruleValidate: {\r\n        title: [{required: true,validator: this.vTitle,trigger: \"blur\"}],\r\n        city: [ { required: true, message: '请选择城市', trigger: 'change' }]\r\n      },\r\n      content: \"\",\r\n      toolbars: {\r\n        bold: true, // 粗体\r\n        italic: false, // 斜体\r\n        header: true, // 标题\r\n        underline: false, // 下划线\r\n        strikethrough: false, // 中划线\r\n        mark: false, // 标记\r\n        superscript: false, // 上角标\r\n        subscript: false, // 下角标\r\n        quote: false, // 引用\r\n        ol: true, // 有序列表\r\n        ul: false, // 无序列表\r\n        link: false, // 链接\r\n        imagelink: true, // 图片链接\r\n        code: false, // code\r\n        ishljs: true, // 代码块高亮\r\n        table: false, // 表格\r\n        fullscreen: true, // 全屏编辑\r\n        readmodel: false, // 沉浸式阅读\r\n        htmlcode: false, // 展示html源码\r\n        help: false, // 帮助\r\n        /* 1.3.5 */\r\n        undo: true, // 上一步\r\n        redo: true, // 下一步\r\n        trash: true, // 清空\r\n        save: false, // 保存（触发events中的save事件）\r\n        /* 1.4.2 */\r\n        navigation: false, // 导航目录\r\n        /* 2.1.8 */\r\n        alignleft: true, // 左对齐\r\n        aligncenter: true, // 居中\r\n        alignright: false, // 右对齐\r\n        /* 2.2.1 */\r\n        subfield: false, // 单双栏模式\r\n        preview: true, // 预览\r\n      },\r\n      showContent: \"\",\r\n      tagList: [\r\n        {\r\n          title: \"卧室\",\r\n          check: false,\r\n        },\r\n        {\r\n          title: \"客厅\",\r\n          check: false,\r\n        },\r\n        {\r\n          title: \"书房\",\r\n          check: false,\r\n        },\r\n        {\r\n          title: \"厨房\",\r\n          check: false,\r\n        },\r\n        {\r\n          title: \"餐厅\",\r\n          check: false,\r\n        },\r\n        {\r\n          title: \"玄关\",\r\n          check: false,\r\n        },\r\n        {\r\n          title: \"阳台\",\r\n          check: false,\r\n        },\r\n        {\r\n          title: \"儿童房\",\r\n          check: false,\r\n        },\r\n        {\r\n          title: \"卫生间\",\r\n          check: false,\r\n        },\r\n      ],\r\n      editData: {},\r\n      contentMD: \"\",\r\n      dynamicId: null, // 动态id\r\n      styleList: [], // 装修风格列表\r\n      styleId: 1,\r\n      city: '',\r\n      markdownText: ''\r\n    };\r\n  },\r\n  created() {\r\n    this.dynamicId = this.$route.params.id;\r\n    this.getStyleList();\r\n    if (this.dynamicId) this.getDynamic();\r\n  },\r\n  mounted() {\r\n\r\n  },\r\n  methods: {\r\n    vTitle(rule, value, callback) {\r\n      if (value.length > 30 || value.length < 2) {\r\n        callback(new Error(\"标题2-30字之间\"));\r\n      }else if(filtion(value)){\r\n        callback(new Error(\"标题存在敏感词\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    },\r\n    // 获取编辑动态内容详情\r\n    async getDynamic() {\r\n      try {\r\n        let res = await this.$http.post(\"/client/dynamic_edit_detail\", {\r\n          id: this.dynamicId,\r\n        });\r\n        let data = res.data.data;\r\n        this.formValidate.title = data.title;\r\n        this.formValidate.city = data.city;\r\n        this.contentMD = data.content_md;\r\n        this.content = data.content_md;\r\n        this.styleId = data.style;\r\n        this.editData = data;\r\n        this.tagList.forEach((v) => {\r\n          if (data.tags.indexOf(v.title) != -1) {\r\n            v.check = true;\r\n          }\r\n        });\r\n      } catch (err) { }\r\n    },\r\n    // 获取装修风格列表\r\n    async getStyleList() {\r\n      let res = await this.$http.get('/client/find_style_list');\r\n      this.styleList = res.data.data;\r\n    },\r\n    handleReset(name) {\r\n      this.$refs[name].resetFields();\r\n    },\r\n    getFormdata(v) {\r\n      this.formValidate.cover = v;\r\n    },\r\n    // 修改内容时触发\r\n    changeData(value, render) {\r\n      // value中是文本值,render是渲染出的html文本\r\n      this.showContent = render;\r\n      this.markdownText = value.replace(/[^\\u4E00-\\u9FA5]/g,'');\r\n      if(filtion(this.markdownText)) return this.$Message.error('动态内容存在敏感词...');\r\n    },\r\n    async testResDy() {\r\n      let res = await this.$http.post(\"/testResDy\", { data: this.showContent });\r\n      console.log(res);\r\n    },\r\n    // 提交发布\r\n    releaseDynamics() {\r\n      this.$refs[\"formValidate\"].validate(async (valid) => {\r\n        if(filtion(this.markdownText)) return this.$Message.error('动态内容存在敏感词...');\r\n        if (valid) {\r\n          if (this.showContent == \"\")\r\n            return this.$Message.error(\"请先编辑动态内容\");\r\n          if (!this.formValidate.cover && !this.dynamicId)\r\n            return this.$Message.error(\"请上传封面\");\r\n          let tags = this.tagList.map((v) => (v.check === true ? v.title : null)).filter((v) => v).join(\",\");\r\n          this.contentMD = this.$refs.md.d_value;\r\n          let data = {\r\n            id: this.dynamicId,\r\n            title: this.formValidate.title,\r\n            contentHTML: this.showContent,\r\n            contentMD: this.contentMD,\r\n            tags,\r\n            city: this.formValidate.city\r\n          };\r\n          const formData = new FormData();\r\n          formData.append(\"file\", this.formValidate.cover);\r\n          formData.append(\"info\", JSON.stringify(data));\r\n          let res = null;\r\n          if (this.dynamicId) {\r\n            res = await this.$http.post(\"/client/edit_dynamic\", formData);\r\n          } else {\r\n            res = await this.$http.post(\"/client/release_dynamics\", formData);\r\n          }\r\n          if (res.data.status === 0) {\r\n            setTimeout(() => {\r\n              this.$router.go(-1);\r\n            }, 600);\r\n          }\r\n        } else {\r\n          this.$Message.error(\"请填写完整信息!\");\r\n        }\r\n      });\r\n    },\r\n    // 将图片上传到服务器，返回地址替换到md中\r\n    imgAdd(pos, $file) {\r\n      var _this = this;\r\n      var formdata = new FormData();\r\n      formdata.append(\"file\", $file);\r\n      this.$http.upload(\"/upload\", formdata).then((response) => {\r\n        // 第二步.将返回的url替换到文本原位置![...](0) -> ![...](url)\r\n        if (response.status === 200) {\r\n          var url = response.data.data[0].url;\r\n          _this.$refs.md.$img2Url(pos, url);\r\n        }\r\n      });\r\n    },\r\n    // 通过城市查找省份和城市，并组成数组\r\n    findCity(city) {\r\n      let p = null;\r\n      let d = null\r\n      for (let i = 0; i < address.length; i++) {\r\n        let c = address[i].children.filter(v => v.label == city);\r\n        if (c.length > 0) {\r\n          p = address[i].label;\r\n          d = c[0].label;\r\n          break;\r\n        }\r\n      }\r\n      return [p, d];\r\n    },\r\n    imgDel(pos) { },\r\n    // md全屏\r\n    fullScreen(status) {\r\n      // console.log(status);\r\n    },\r\n  }\r\n  // beforeRouteLeave(to, from, next) {\r\n  //   if(this.showContent){\r\n  //     this.$Modal.confirm({\r\n  //       title: \"提示\",\r\n  //       content: \"<p>离开后您所编辑的内容会清空，您确定要离开吗</p>\",\r\n  //       onOk: () => {\r\n  //         next();\r\n  //       },\r\n  //       onCancel: () => {\r\n  \r\n  //       },\r\n  //     });\r\n  //   }else next();\r\n  // }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.releaseDynamics {\r\n  background: #fff;\r\n  position: relative;\r\n  .form {\r\n    width: 60%;\r\n    padding: 20px;\r\n    // margin: auto;\r\n  }\r\n  .markdown {\r\n    position: relative;\r\n    z-index: 1;\r\n    height: 550px;\r\n    .v-note-wrapper.markdown-body.shadow {\r\n      // height: 550px;\r\n      height: 100%;\r\n    }\r\n  }\r\n  .commit-box {\r\n    margin: auto;\r\n    width: 30%;\r\n    padding: 20px 0 40px;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ReleaseDynamics.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ReleaseDynamics.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ReleaseDynamics.vue?vue&type=template&id=3d70d880&scoped=true&\"\nimport script from \"./ReleaseDynamics.vue?vue&type=script&lang=js&\"\nexport * from \"./ReleaseDynamics.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ReleaseDynamics.vue?vue&type=style&index=0&id=3d70d880&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3d70d880\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","value","data3","placeholder","format","on","change","staticRenderFns","name","props","type","default","data","created","code","label","children","methods","component","staticClass","ref","formValidate","ruleValidate","staticStyle","model","title","callback","$$v","$set","expression","_l","tagList","v","i","key","check","_v","_s","findCity","city","styleId","styleList","item","id","editData","cover","toolbars","fullScreen","imgAdd","imgDel","changeData","content","releaseDynamics","components","UploadHeadImg","Address","required","validator","trigger","message","bold","italic","header","underline","strikethrough","mark","superscript","subscript","quote","ol","ul","link","imagelink","ishljs","table","fullscreen","readmodel","htmlcode","help","undo","redo","trash","save","navigation","alignleft","aligncenter","alignright","subfield","preview","showContent","contentMD","dynamicId","markdownText","mounted","vTitle","handleReset","getFormdata","console","contentHTML","tags","formData","res","setTimeout","formdata","_this","p","d"],"sourceRoot":""}